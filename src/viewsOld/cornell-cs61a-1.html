<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <title>Lexture - Berkeley CS 61A - Week 1: Functions</title>
    <link rel="icon" type="image/png" href="../assets/favicon.png" />
    <!--Bootstrap CSS-->
    <link rel="stylesheet" href="../stylesheets/bootstrap.min.css" />
    <!--Video.js CSS-->
    <link href="https://vjs.zencdn.net/7.5.5/video-js.css" rel="stylesheet" />
    <!--Custom CSS-->
    <link rel="stylesheet" href="../stylesheets/base.css" />
    <link rel="stylesheet" href="../stylesheets/video.css" />
  </head>
  <body>
    <nav class="navbar navbar-expand-lg navbar-light" id="lexture-navbar">
      <a class="navbar-brand ml-3" href="index.html">
        <img src="../assets/logo.png" height="40" alt="" />
      </a>

      <button
        class="navbar-toggler"
        type="button"
        data-toggle="collapse"
        data-target="#navbarSupportedContent"
        aria-controls="navbarSupportedContent"
        aria-expanded="false"
        aria-label="Toggle navigation"
      >
        <span class="navbar-toggler-icon"></span>
      </button>

      <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <form class="form-inline mx-auto">
          <input
            class="form-control mr-0 rounded-0"
            id="lexture-search-bar"
            type="search"
            placeholder="Search"
            aria-label="Search"
          />
          <button class="btn btn-light px-2 rounded-0" id="lexture-search-btn" type="submit">
            <img src="../assets/search.png" height="21" alt="Search" />
          </button>
        </form>

        <a class="navbar-brand mr-3 ml-5" href="index.html">
          <img src="../assets/profile.png" height="45" alt="Profile" />
        </a>
      </div>
    </nav>

    <div class="breadcrumb-bar">
      <nav aria-label="breadcrumb">
        <ol class="breadcrumb" id="lexture-breadcrumb">
          <li class="breadcrumb-item"><a href="#">Berkeley CS 61A</a></li>
          <li class="breadcrumb-item active" aria-current="page">
            Week 1: Functions
          </li>
        </ol>
      </nav>
    </div>

    <div class="container">
      <div class="left-section">
        <div class="card text-search-timestamp-card" id="timestamp-card-1">
          <div class="card-body">
            <div class="card-body-left-align">
              <div class="play-btn"></div>
              <p class="text-search-snippet text-truncate">
                will be on the
                <span class="search-term-highlight">test</span> for the next quiz next Tuesday.
              </p>
            </div>
            <p class="text-search-timestamp">00:42</p>
          </div>
        </div>
        <div class="card text-search-timestamp-card" id="timestamp-card-2">
          <div class="card-body">
            <div class="card-body-left-align">
              <div class="play-btn"></div>
              <p class="text-search-snippet text-truncate">
                won't be on the <span class="search-term-highlight">test</span>, it's just fun to
                talk about.
              </p>
            </div>
            <p class="text-search-timestamp">04:20</p>
          </div>
        </div>
        <div class="card text-search-timestamp-card" id="timestamp-card-3">
          <div class="card-body">
            <div class="card-body-left-align">
              <div class="play-btn"></div>
              <p class="text-search-snippet text-truncate">
                to study for the
                <span class="search-term-highlight">test</span> that's coming out this Friday.
              </p>
            </div>
            <p class="text-search-timestamp">42:00</p>
          </div>
        </div>

<!--I added this section thinking it'd be a good thing to have when there are no search results on the left half.-->
<!--However, thinking some more, I think I'd rather just put this function into the transcription section below.-->
<!--        <form class="form-inline mx-auto mt-4">-->
<!--          <input-->
<!--                  class="form-control mr-0 rounded-0"-->
<!--                  id="video-search-bar"-->
<!--                  type="search"-->
<!--                  placeholder="Search in this video"-->
<!--                  aria-label="Search"-->
<!--          />-->
<!--          <button class="btn btn-light px-2 rounded-0" id="video-search-btn" type="submit">-->
<!--            <img src="../assets/search.png" height="21" alt="Search" />-->
<!--          </button>-->
<!--        </form>-->
      </div>

      <div class="right-section">
        <video
          id="lecture-video"
          class="video-js vjs-big-play-centered"
          controls
          preload="auto"
          data-setup="{}"
        >
          <source
            src="https://lexture.nyc3.digitaloceanspaces.com/sample_lectures/berkeley_cs61a_1.mp4"
            type="video/mp4"
          />
          <p class="vjs-no-js">Your browser does not support HTML5 video.</p>
          <!--            <track kind="captions" src="http://example.com/path/to/captions.vtt" srclang="en" label="English" default>-->
        </video>
        <div class="card-below-video">
          <div class="tool-tab-bar">
            <div class="tool-tab selected-tool-tab" id="overview-tab">
              Overview
            </div>
            <div class="tool-tab" id="transcript-tab">Transcript</div>
            <div class="tool-tab" id="qna-tab">Q&A</div>
            <div class="tool-tab" id="mytags-tab">My Tags</div>
          </div>
          <div class="card-below-video-content" id="overview-card">
            <div class="course-lecturer">
              Course Lecturer:
              <img class="lecturer-photo" src="../assets/kieran.png" alt="" width="35" />
              Kieran Taylor
            </div>
            <div class="tags-row">
              <div class="topic-tag">Algorithms</div>
              <div class="topic-tag">Introduction</div>
              <div class="topic-tag">Computer Science</div>
            </div>
            <div class="overview-text">
              Kieran is a proficient speaker of Chinese and the world's leading authority on
              professional bar fighting. He was born in a volcano as it erupted, raised by Shaolin
              masters, and has the power of three legendary pokemon combined.
            </div>
          </div>
          <div class="card-below-video-content" id="transcript-card">
            <form>
              <div class="form-group">
                <select class="form-control" id="transcript-language-select">
                  <option>English</option>
                  <option>中文</option>
                  <option>Español</option>
                  <option>Binary</option>
                </select>
              </div>
            </form>
            <div class="transcript-text">
              <span
                class="transcript-line"
                data-trigger="hover"
                data-toggle="popover"
                data-content="00:00"
                >Lorem ipsum dolor sit amet, consectetur adipiscing elit.</span
              >
              <span
                class="transcript-line"
                data-trigger="hover"
                data-toggle="popover"
                data-content="00:10"
                >Proin eget malesuada velit.</span
              >
              <span
                class="transcript-line"
                data-trigger="hover"
                data-toggle="popover"
                data-content="00:20"
                >Donec auctor est sapien, luctus lobortis libero congue eu.</span
              >
              <span
                class="transcript-line"
                data-trigger="hover"
                data-toggle="popover"
                data-content="00:30"
                >Nullam commodo placerat sagittis.</span
              >
              <span
                class="transcript-line"
                data-trigger="hover"
                data-toggle="popover"
                data-content="00:40"
                >Phasellus finibus nisi erat, et dictum sapien molestie id.</span
              >
              <span
                class="transcript-line"
                data-trigger="hover"
                data-toggle="popover"
                data-content="00:50"
                >Cras in bibendum risus.</span
              >
              <span
                class="transcript-line"
                data-trigger="hover"
                data-toggle="popover"
                data-content="01:00"
                >Fusce rhoncus magna mi, tristique ornare ipsum consectetur ut.</span
              >
            </div>
          </div>
          <div class="card-below-video-content" id="qna-card">
            <form id="qna-search-form">
              <div class="form-group form-inline">
                <input
                  class="form-control mr-0 rounded-0"
                  id="qna-search-bar"
                  type="search"
                  placeholder="Search"
                  aria-label="Search"
                />
                <button class="btn btn-light px-2 rounded-0" id="qna-search-btn" type="submit">
                  <img src="../assets/search.png" height="21" alt="Search" />
                </button>
              </div>
              <div class="form-group">
                <select class="form-control" id="qna-sort-select">
                  <option>Most Recent</option>
                  <option>Most Liked</option>
                  <option>Most Comments</option>
                </select>
              </div>
              <div class="form-group">
                <select class="form-control" id="qna-filter-select">
                  <option>All</option>
                  <option>My Questions</option>
                  <option>Answered</option>
                  <option>Unanswered</option>
                </select>
              </div>
            </form>
            <form id="qna-submission-form">
              <img src="../assets/profile.png" height="35" alt="Profile" />
              <input
                class="form-control rounded-0"
                id="qna-submission-bar"
                type="search"
                placeholder="Ask a question..."
                aria-label="Ask a question"
              />
              <button
                class="btn btn-light rounded-0"
                id="qna-submission-btn"
                type="button"
                data-container="body"
                data-toggle="popover"
                data-placement="bottom"
                data-content="You asked a question successfully!"
              >
                Ask
              </button>
            </form>
            <div class="qna-others-entry">
              <!--                    <img src="assets/profile.png" height="35" alt="Profile">-->
              <!--                    <div class="question-text">Lorem ipsum dolor sit amet, consectetur adipiscing elit.</div>-->
              <!--                    <button class="btn" id="qna-comment-btn" type="button"></button>-->
              <!--                    <button class="btn" id="qna-like-btn" type="button"></button>-->
            </div>
            <div class="my-qna"></div>
          </div>
          <div class="card-below-video-content" id="mytags-card">
            <div class="mytag-entry"></div>
          </div>
        </div>
      </div>
    </div>
    <!--jQuery-->
    <script
      src="https://code.jquery.com/jquery-3.4.1.min.js"
      integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo="
      crossorigin="anonymous"
    ></script>
    <!--Popper.js-->
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"
      integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
      crossorigin="anonymous"
    ></script>
    <!--Bootstrap JS-->
    <script src="../scripts/bootstrap.min.js"></script>
    <!--Video.js-->
    <script src="https://vjs.zencdn.net/7.5.5/video.js"></script>
    <!--Custom JS-->
    <script>
      function jumpToTime(timestampCard, video) {
        var timeText = timestampCard.find(".text-search-timestamp").text();
        var timeArr = timeText.split(":");
        var timestamp = parseInt(timeArr[0]) * 60 + parseInt(timeArr[1]);
        console.log("Jumping to timestamp: " + timestamp);
        video.currentTime(timestamp);
        video.play();
      }

      function selectTimestampCard(currTimestampCard, targetTimestampCard, video) {
        if (currTimestampCard) {
          currTimestampCard.removeClass("selected-timestamp-card");
        }
        targetTimestampCard.addClass("selected-timestamp-card");
        jumpToTime(targetTimestampCard, video);
        return targetTimestampCard;
      }

      function switchTab(currTab, currCard, targetTab, targetCard) {
        currTab.removeClass("selected-tool-tab");
        targetTab.addClass("selected-tool-tab");
        currCard.css("display", "none");
        targetCard.css("display", "block");
        return [targetTab, targetCard];
      }

      function transcriptJumpToTime(timestampText, video) {
        var timeArr = timestampText.split(":");
        var timestamp = parseInt(timeArr[0]) * 60 + parseInt(timeArr[1]);
        console.log("Jumping to timestamp: " + timestamp);
        video.currentTime(timestamp);
        video.play();
      }

      $(document).ready(function () {
        var video = videojs("lecture-video");

        // Get query string parameters and set video timestamp
        var urlParams = new URLSearchParams(window.location.search);
        if (urlParams.has("t")) {
          var timestampParam = urlParams.get("t");
          var timestamp = parseInt(timestampParam);
          console.log("Jumping to timestamp: " + timestamp);
          video.currentTime(timestamp);
          video.play();
        }

        // Enable popovers
        $('[data-toggle="popover"]').popover({
          placement: 'bottom',
          delay: {
            "show": 500,
            "hide": 100
          }
        }).click(function () {
          setTimeout(function () {
            $('.popover').fadeOut('slow');
          }, 4000);

        });

        // Select search results (timestamp card)
        var currTimestampCard = null;
        $(".text-search-timestamp-card").click(function () {
          currTimestampCard = selectTimestampCard(currTimestampCard, $(this), video);
        });

        // Switch between tabs
        var currTab = $("#overview-tab");
        var currCard = $("#overview-card");
        $("#overview-tab").click(function () {
          [currTab, currCard] = switchTab(currTab, currCard, $("#overview-tab"), $("#overview-card"));
        });
        $("#transcript-tab").click(function () {
          [currTab, currCard] = switchTab(currTab, currCard, $("#transcript-tab"), $("#transcript-card"));
        });
        $("#qna-tab").click(function () {
          [currTab, currCard] = switchTab(currTab, currCard, $("#qna-tab"), $("#qna-card"));
        });
        $("#mytags-tab").click(function () {
          [currTab, currCard] = switchTab(currTab, currCard, $("#mytags-tab"), $("#mytags-card"));
        });

        // Click transcript -> jump to timestamp
        $(".transcript-line").click(function () {
          transcriptJumpToTime($(this).data("content"), video);
        });
      });
    </script>
  </body>
</html>
